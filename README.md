# Документация приложения "Анализ урожайности сельскохозяйственных культур"

## Оглавление

- [Описание](#описание)
- [Системные требования](#системные-требования)
- [Установка](#установка)
- [Структура проекта](#структура-проекта)
- [Руководство пользователя](#руководство-пользователя)
- [Техническая документация](#техническая-документация)
- [API документация](#api-документация)
- [Устранение неполадок](#устранение-неполадок)


## Описание

Приложение предназначено для статистического анализа урожайности различных сортов сельскохозяйственных культур при использовании различных типов удобрений. Программа позволяет загружать данные из CSV/Excel файлов, проводить дисперсионный анализ (ANOVA), строить графики и экспортировать результаты.

### Основные возможности:

- ✅ Загрузка и валидация данных из CSV/Excel файлов
- ✅ Двухфакторный дисперсионный анализ (ANOVA)
- ✅ Post-hoc тест Тьюки (Tukey HSD)
- ✅ Расчет описательных статистик
- ✅ Построение различных типов графиков
- ✅ Экспорт результатов и графиков
- ✅ Интуитивно понятный графический интерфейс


### Авторы:

**Студенты группы ЦИС-33:**

- Смирнов М.А.
- Блинов И.А.
- Лешина Д.А.


## Системные требования

### Минимальные требования:

- **ОС:** Windows 10/11, macOS 10.14+, Linux Ubuntu 18.04+
- **Python:** 3.8 или выше
- **RAM:** 4 ГБ
- **Свободное место:** 500 МБ


### Рекомендуемые требования:

- **ОС:** Windows 11, macOS 12+, Linux Ubuntu 20.04+
- **Python:** 3.10 или выше
- **RAM:** 8 ГБ
- **Свободное место:** 1 ГБ


## Установка

### 1. Установка Python зависимостей

```shellscript
pip install PyQt6 pandas numpy matplotlib seaborn statsmodels scipy
```

### 2. Клонирование проекта

```shellscript
git clone https://github.com/sshyta/FertYieldExplorer.git
cd FertYieldExplorer
```

### 3. Запуск приложения

```shellscript
python main.py
```

## Структура проекта

```plaintext
FERTYIELDEXPLORER/
├── logic/
│   ├── anova.py              # Статистические тесты и анализ
│   └── charts.py             # Логика построения графиков
├── mnt/
│   └── data/
│       ├── origin_data.csv   # Исходные данные
│       └── trash_data.csv    # Тестовые/временные данные
├── ui/
│   ├── __pycache__/          # Кэш Python файлов
│   │   ├── res_rc.cpython-313.pyc
│   │   ├── res_rc.cpython-311.pyc
│   │   ├── ui_rc.cpython-313.pyc
│   │   ├── ui_main.cpython-311.pyc
│   │   └── ui_main.cpython-313.pyc
│   ├── icons/                # Иконки интерфейса
│   ├── main.ui               # Qt Designer файл интерфейса
│   ├── res_rc.py             # Ресурсы Qt (автогенерированный)
│   ├── res_rc.qrc            # Файл ресурсов Qt
│   └── ui_main.py            # Автогенерированный UI код
├── views/
│   ├── __pycache__/          # Кэш Python файлов
│   ├── analysis_view.py      # Модуль статистического анализа
│   ├── charts_view.py        # Модуль визуализации данных
│   ├── data_view.py          # Модуль работы с данными
│   └── home_view.py          # Главное окно приложения
├── .gitignore                # Исключения для Git
├── LICENSE                   # Лицензия проекта
├── main.py                   # Точка входа в приложение
├── poetry.lock               # Зафиксированные версии зависимостей
├── pyproject.toml           # Конфигурация проекта и зависимости
└── README.md                # Основная документация
```

## Руководство пользователя

### Запуск приложения

1. Запустите файл `main.py`
2. Откроется главное окно приложения с четырьмя вкладками:

1. **Home** - Главная страница
2. **Data** - Работа с данными
3. **Analysis** - Статистический анализ
4. **Charts** - Графики и визуализация


### Работа с данными

#### Загрузка данных

1. Перейдите на вкладку **Data**
2. Нажмите кнопку **Load Data**
3. Выберите CSV или Excel файл с данными


**Требования к формату данных:**

- Файл должен содержать три колонки: `Сорт`, `Удобрение`, `Урожайность`
- Колонка `Урожайность` должна содержать только числовые значения
- Минимум 3 строки данных


**Пример корректных данных:**

```csv

  012
  СортУдобрениеУрожайностьСорт AУдобрение X25.5Сорт AУдобрение Y28.3Сорт BУдобрение X22.1


```

#### Валидация данных

Приложение автоматически проверяет:

- ✅ Наличие обязательных колонок
- ✅ Корректность числовых значений
- ✅ Отсутствие пустых ячеек
- ✅ Недопустимые символы
- ✅ Экстремальные значения


При обнаружении ошибок появится детальное сообщение с описанием проблем.

#### Создание тестовых данных

Для ознакомления с функционалом нажмите кнопку **Создать тестовые данные** - будет сгенерирован набор данных для демонстрации.

### Статистический анализ

#### Проведение ANOVA

1. Перейдите на вкладку **Analysis**
2. Убедитесь, что данные загружены
3. Выберите тип анализа: **ANOVA**
4. Отметьте факторы для анализа:

1. ☑️ Сорт культуры
2. ☑️ Тип удобрения
3. ☑️ Взаимодействие (опционально)



5. Нажмите **Запустить анализ**


**Интерпретация результатов ANOVA:**

- **p < 0.05** - статистически значимое влияние фактора
- **p ≥ 0.05** - статистически незначимое влияние фактора


#### Post-hoc тест Тьюки

1. Выберите тип анализа: **Tukey HSD**
2. Нажмите **Запустить анализ**


Тест показывает, какие конкретно группы статистически значимо отличаются друг от друга.

#### Описательные статистики

1. Выберите тип анализа: **Описательные статистики**
2. Нажмите **Запустить анализ**


Получите базовые статистические показатели по группам.

### Визуализация данных

#### Основные графики

1. Перейдите на вкладку **Charts**
2. На вкладке **Основной график** выберите тип:

1. **Столбчатая** - средняя урожайность по сортам
2. **Ящик с усами** - распределение по удобрениям
3. **Точечная** - все точки данных

3. Отметьте **Show Trend** для отображения средней линии

#### Графики сравнения

1. Перейдите на вкладку **График сравнения**
2. Выберите группировку:

1. **По сортам** - сравнение сортов для каждого удобрения
2. **По удобрениям** - сравнение удобрений для каждого сорта

#### Дополнительные графики

- **Взаимодействие** - график взаимодействия факторов
- **Тепловая карта** - визуализация средних значений

#### Экспорт данных

- Кнопка **Export Results** на вкладке Data
- Поддерживаемые форматы: CSV, Excel

#### Экспорт результатов анализа

- Кнопка **Экспорт результатов** на вкладке Analysis
- Формат: TXT файл с результатами

#### Экспорт графиков

- Кнопка **Export graph** на вкладке Charts
- Поддерживаемые форматы: PNG, PDF, SVG, JPEG


## Техническая документация

### Архитектура приложения

Приложение построено по модульной архитектуре с разделением на слои:

```plaintext
Presentation Layer (UI)
├── home_view.py
├── data_view.py
├── analysis_view.py
└── charts_view.py

Business Logic Layer
├── anova.py
└── charts.py

Data Layer
└── pandas DataFrames
```

### Основные классы

#### MainWindow (home_view.py)

Главный класс приложения, наследующий от `QMainWindow` и `Ui_MainWindow`.

**Основные методы:**

- `__init__()` - инициализация окна
- `show_error_message(text)` - отображение ошибок
- `show_info_message(text)` - отображение информации


#### Модули представлений

**data_view.py:**

- `setup_data_page(window)` - настройка страницы данных
- `load_data()` - загрузка и валидация данных
- `validate_data_quality(data)` - комплексная валидация


**analysis_view.py:**

- `setup_analysis_page(window)` - настройка страницы анализа
- `run_analysis()` - запуск статистических тестов


**charts_view.py:**

- `setup_charts_page(window)` - настройка страницы графиков
- `update_main_chart(window)` - обновление основного графика


### Статистические методы

#### ANOVA (anova.py)

```python
def run_anova_analysis(data):
    """
    Двухфакторный дисперсионный анализ
    
    Args:
        data (DataFrame): Данные с колонками 'Сорт', 'Удобрение', 'Урожайность'
    
    Returns:
        str: Результаты анализа
    """
```

**Формула модели:**

```plaintext
Урожайность ~ C(Сорт) + C(Удобрение) + C(Сорт):C(Удобрение)
```

#### Tukey HSD

```python
def run_tukey_test(data):
    """
    Post-hoc тест Тьюки для множественных сравнений
    
    Args:
        data (DataFrame): Исходные данные
    
    Returns:
        str: Результаты теста
    """
```

### Валидация данных

#### Проверки качества данных

```python
def validate_data_quality(data):
    """
    Комплексная валидация загруженных данных
    
    Проверки:
    - Пустые данные
    - Минимальное количество строк
    - Пустые значения
    - Недопустимые символы
    - Некорректные числовые значения
    - Отрицательные значения
    - Экстремальные значения
    
    Returns:
        list: Список ошибок валидации
    """
```

## API документация

### Основные функции

#### Загрузка данных

```python
# Поддерживаемые форматы
formats = ['.csv', '.xlsx', '.xls']

# Поддерживаемые разделители CSV
separators = [',', ';', '\t']
```

#### Статистические тесты

```python
# ANOVA
result = run_anova_analysis(data)

# Tukey HSD
result = run_tukey_test(data)

# Описательные статистики
result = calculate_descriptive_stats(data)
```

#### Построение графиков

```python
# Типы графиков
chart_types = ['Столбчатая', 'Ящик с усами', 'Точечная']

# Экспорт графиков
formats = ['PNG', 'PDF', 'SVG', 'JPEG']
```

### Структура данных

#### Входные данные

```python
# Обязательные колонки
required_columns = ['Сорт', 'Удобрение', 'Урожайность']

# Типы данных
dtypes = {
    'Сорт': 'object',
    'Удобрение': 'object', 
    'Урожайность': 'float64'
}
```

#### Результаты ANOVA

```python
# Структура результата
anova_result = {
    'F-statistic': float,
    'p-value': float,
    'degrees_of_freedom': int,
    'sum_of_squares': float
}
```

## Устранение неполадок

### Частые проблемы

#### 1. Ошибка импорта модулей

**Проблема:** `ModuleNotFoundError: No module named 'PyQt6'`

**Решение:**

```shellscript
pip install PyQt6 PySide6 pandas numpy matplotlib seaborn statsmodels scipy
```

#### 2. Ошибка загрузки данных

**Проблема:** "Отсутствуют необходимые колонки"

**Решение:**

- Убедитесь, что файл содержит колонки: `Сорт`, `Удобрение`, `Урожайность`
- Проверьте кодировку файла (рекомендуется UTF-8)
- Используйте правильный разделитель в CSV


#### 3. Ошибки валидации

**Проблема:** "Колонка 'Урожайность' содержит нечисловые значения"

**Решение:**

- Замените текстовые значения на числа
- Удалите лишние символы (%, $, пробелы)
- Используйте точку как десятичный разделитель


#### 4. Недостаточно данных для анализа

**Проблема:** "Недостаточно данных для анализа"

**Решение:**

- Убедитесь, что файл содержит минимум 3 строки данных
- Проверьте, что есть данные для разных сортов и удобрений


### Логи ошибок

Приложение выводит детальные сообщения об ошибках в диалоговых окнах. Для отладки можно запустить приложение из командной строки:

```shellscript
python main.py
```

### Поддержка

При возникновении проблем:

1. Проверьте системные требования
2. Убедитесь в корректности формата данных
3. Проверьте логи ошибок
4. Обратитесь к разработчикам


### Известные ограничения

- Максимальный размер файла: 100 МБ
- Максимальное количество строк: 100,000
- Поддерживаются только числовые значения урожайности
- Требуется минимум 3 наблюдения для статистического анализа
